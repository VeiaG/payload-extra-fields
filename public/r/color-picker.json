{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "color-picker",
  "type": "registry:item",
  "title": "Color Picker",
  "description": "A customizable color picker field for PayloadCMS.",
  "files": [
    {
      "path": "registry/fields/color-picker/field.ts",
      "content": "import { TextField } from 'payload'\r\nimport { ColorPickerArgs } from './types'\r\nimport { text } from 'payload/shared'\r\n\r\nexport const colorField = (options?: ColorPickerArgs): TextField => {\r\n  const baseField: TextField = {\r\n    name: options?.name || 'color',\r\n    type: 'text',\r\n    required: options?.required || false,\r\n    admin: {\r\n      description: options?.description,\r\n      components: {\r\n        Field: {\r\n          path: '@/fields/color-picker',\r\n          clientProps: {\r\n            colorPresets: options?.colorPresets || [],\r\n            debounceDelay: options?.debounceDelay || 300,\r\n            showTextInput: options?.showTextInput !== false, // default true\r\n          },\r\n        },\r\n        Cell: {\r\n          path: '@/fields/color-picker#ColorCell',\r\n          clientProps: {},\r\n        },\r\n      },\r\n    },\r\n    validate: (value, args) => {\r\n      if (value && !/^#([0-9A-F]{3}){1,2}$/i.test(value)) {\r\n        return 'Invalid color format'\r\n      }\r\n      //Reuse Payload's built-in text validation\r\n      return text(value, args)\r\n    },\r\n  }\r\n  if (typeof options?.overrides === 'function') {\r\n    return options.overrides(baseField)\r\n  }\r\n\r\n  return baseField\r\n}\r\n",
      "type": "registry:file",
      "target": "~/src/fields/color-picker/field.ts"
    },
    {
      "path": "registry/fields/color-picker/index.tsx",
      "content": "'use client'\r\nimport {\r\n  FieldDescription,\r\n  FieldError,\r\n  FieldLabel,\r\n  TextInput,\r\n  useField,\r\n  useTranslation,\r\n} from '@payloadcms/ui'\r\nimport { DefaultCellComponentProps, TextFieldClient, TextFieldClientProps } from 'payload'\r\nimport React, { useCallback, useEffect, useRef, useState } from 'react'\r\nimport './style.scss'\r\nimport { ColorPickerProps } from './types'\r\n\r\nconst ColorPicker: React.FC<TextFieldClientProps & ColorPickerProps> = ({\r\n  path,\r\n  field,\r\n  colorPresets,\r\n  debounceDelay = 300,\r\n  showTextInput,\r\n  readOnly,\r\n}) => {\r\n  const { setValue, value, disabled, showError } = useField<string>({ path: path || field.name })\r\n  const [localValue, setLocalValue] = useState(value || '')\r\n  const colorInputRef = useRef<HTMLInputElement>(null)\r\n  const debounceTimerRef = useRef<NodeJS.Timeout | null>(null)\r\n\r\n  const actualReadOnly = readOnly || field.admin?.readOnly || false\r\n\r\n  // Sync external value changes to local state\r\n  useEffect(() => {\r\n    if (value !== localValue) {\r\n      setLocalValue(value || '')\r\n    }\r\n  }, [value])\r\n\r\n  // Debounced value update\r\n  const debouncedSetValue = useCallback(\r\n    (newValue: string) => {\r\n      if (debounceTimerRef.current) {\r\n        clearTimeout(debounceTimerRef.current)\r\n      }\r\n\r\n      debounceTimerRef.current = setTimeout(() => {\r\n        setValue(newValue)\r\n      }, debounceDelay)\r\n    },\r\n    [setValue, debounceDelay],\r\n  )\r\n\r\n  // Cleanup debounce timer on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (debounceTimerRef.current) {\r\n        clearTimeout(debounceTimerRef.current)\r\n      }\r\n    }\r\n  }, [])\r\n\r\n  const handleColorChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const newColor = e.target.value\r\n    setLocalValue(newColor)\r\n    debouncedSetValue(newColor)\r\n  }\r\n\r\n  const handlePresetClick = (color: string) => {\r\n    if (actualReadOnly) return\r\n    setLocalValue(color)\r\n    setValue(color) // Immediate update for preset clicks\r\n    if (colorInputRef.current) {\r\n      colorInputRef.current.value = color\r\n    }\r\n  }\r\n\r\n  const handleTextInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    let newColor = e.target.value\r\n\r\n    // Auto-add # if missing\r\n    if (newColor && !newColor.startsWith('#')) {\r\n      newColor = `#${newColor}`\r\n    }\r\n\r\n    setLocalValue(newColor)\r\n    //Update value with debounce, validation will handle incorrect formats\r\n    debouncedSetValue(newColor)\r\n  }\r\n\r\n  const isValidHex = /^#[0-9A-Fa-f]{6}$/.test(localValue)\r\n\r\n  return (\r\n    <div className=\"color-picker\">\r\n      <FieldLabel\r\n        label={field.label}\r\n        localized={field.localized}\r\n        path={path}\r\n        required={field.required}\r\n      />\r\n      <div className=\"color-picker__main\">\r\n        <div className=\"color-picker__input-group\">\r\n          <input\r\n            ref={colorInputRef}\r\n            type=\"color\"\r\n            id={`color-${field.name}`}\r\n            className=\"color-picker__color-input\"\r\n            value={isValidHex ? localValue : '#000000'}\r\n            onChange={handleColorChange}\r\n            disabled={actualReadOnly}\r\n          />\r\n          {showTextInput && (\r\n            <TextInput\r\n              value={localValue}\r\n              onChange={handleTextInputChange}\r\n              placeholder=\"#000000\"\r\n              readOnly={actualReadOnly || disabled}\r\n              path={path} // Provide path for Payload's form handling\r\n              required={field.required}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {!isValidHex && localValue && (\r\n          <div className=\"color-picker__error\">Invalid hex color format</div>\r\n        )}\r\n        <FieldError showError={showError} path={path} />\r\n      </div>\r\n\r\n      {colorPresets && colorPresets.length > 0 && (\r\n        <div\r\n          className={`color-picker__presets ${actualReadOnly || disabled ? 'color-picker__presets--disabled' : ''}`}\r\n        >\r\n          <div className=\"color-picker__presets-label\">Presets:</div>\r\n          <div className=\"color-picker__presets-grid\">\r\n            {colorPresets.map((color, index) => (\r\n              <button\r\n                key={`${color}-${index}`}\r\n                type=\"button\"\r\n                className={`color-picker__preset ${\r\n                  localValue.toLowerCase() === color.toLowerCase()\r\n                    ? 'color-picker__preset--active'\r\n                    : ''\r\n                }`}\r\n                style={{ backgroundColor: color }}\r\n                onClick={() => handlePresetClick(color)}\r\n                disabled={actualReadOnly || disabled}\r\n                title={color}\r\n                aria-label={`Select color ${color}`}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n      <FieldDescription description={field.admin?.description} path={path} />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const ColorCell: React.FC<DefaultCellComponentProps<TextFieldClient>> = (props) => {\r\n  const { cellData, field } = props\r\n  const { i18n } = useTranslation()\r\n\r\n  return (\r\n    <div className=\"color-cell\">\r\n      {cellData && <div style={{ backgroundColor: cellData }} className=\"cell-indicator\" />}\r\n      <span>\r\n        {cellData\r\n          ? cellData\r\n          : i18n.t('general:noLabel', {\r\n              //Using field name, to prevent requiring \"@payloadcms/translations\"\r\n              //As ShadcnCLI will install latest version, which may be incompatible with Payload's version\r\n\r\n              //You can replace it with `getTranslation(('label' in field ? field.label : null) || 'data', i18n),`\r\n              //And install \"@payloadcms/translations\" with same version as Payload, to get the actual localized label\r\n              label: field.name,\r\n            })}\r\n      </span>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ColorPicker\r\n",
      "type": "registry:file",
      "target": "~/src/fields/color-picker/index.tsx"
    },
    {
      "path": "registry/fields/color-picker/style.scss",
      "content": ".color-picker {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-bottom: 1.5rem;\r\n\r\n  &__main {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 0.5rem;\r\n  }\r\n\r\n  &__input-group {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 0.75rem;\r\n    margin-bottom: 0.75rem;\r\n  }\r\n\r\n  &__color-input {\r\n    width: 42px;\r\n    height: 42px;\r\n    border: 2px solid var(--theme-elevation-150, #e0e0e0);\r\n    border-radius: var(--style-radius-s);\r\n    cursor: pointer;\r\n    padding: 0;\r\n    background: none;\r\n    transition: all 0.2s ease;\r\n\r\n    &:hover:not(:disabled) {\r\n      border-color: var(--theme-elevation-400, #999);\r\n    }\r\n\r\n    &:focus {\r\n      outline: none;\r\n      border-color: var(--theme-elevation-500, #4a90e2);\r\n      box-shadow: 0 0 0 3px var(--theme-elevation-50, rgba(74, 144, 226, 0.1));\r\n    }\r\n\r\n    &:disabled {\r\n      opacity: 0.5;\r\n      cursor: not-allowed;\r\n      background-color: var(--theme-elevation-100, #f5f5f5);\r\n    }\r\n\r\n    // Remove default color input styling\r\n    &::-webkit-color-swatch-wrapper {\r\n      padding: 0;\r\n      border-radius: var(--style-radius-s);\r\n    }\r\n\r\n    &::-webkit-color-swatch {\r\n      border: none;\r\n    }\r\n\r\n    &::-moz-color-swatch {\r\n      border: none;\r\n      border-radius: var(--style-radius-s);\r\n    }\r\n  }\r\n\r\n  &__error {\r\n    font-size: var(--font-size-small, 0.75rem);\r\n    color: var(--theme-error-500, #e63946);\r\n    padding: 0.25rem 0.5rem;\r\n    background-color: var(--theme-error-50, #ffe5e5);\r\n    display: inline-block;\r\n  }\r\n\r\n  &__presets {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 0.5rem;\r\n    padding-top: 0.5rem;\r\n    border-top: 1px solid var(--theme-elevation-150, #e0e0e0);\r\n\r\n    &--disabled {\r\n      opacity: 0.6;\r\n    }\r\n  }\r\n\r\n  &__presets-label {\r\n    font-size: var(--font-size-small, 0.8125rem);\r\n    font-weight: 500;\r\n    color: var(--theme-elevation-600, #666);\r\n  }\r\n\r\n  &__presets-grid {\r\n    display: grid;\r\n    grid-template-columns: repeat(auto-fill, minmax(36px, 1fr));\r\n    gap: 0.5rem;\r\n    max-width: 100%;\r\n  }\r\n\r\n  &__preset {\r\n    width: 36px;\r\n    height: 36px;\r\n    border: 2px solid var(--theme-elevation-150, #e0e0e0);\r\n    cursor: pointer;\r\n    transition: all 0.2s ease;\r\n    padding: 0;\r\n    position: relative;\r\n    overflow: hidden;\r\n    border-radius: var(--style-radius-s);\r\n\r\n    &:hover:not(:disabled) {\r\n      transform: translateY(-2px);\r\n      box-shadow: 0 4px 8px var(--theme-elevation-200, rgba(0, 0, 0, 0.15));\r\n      border-color: var(--theme-elevation-400, #999);\r\n    }\r\n\r\n    &:focus {\r\n      outline: none;\r\n      border-color: var(--theme-elevation-500, #4a90e2);\r\n      box-shadow: 0 0 0 3px var(--theme-elevation-100, rgba(74, 144, 226, 0.2));\r\n    }\r\n\r\n    &:active:not(:disabled) {\r\n      transform: translateY(0);\r\n    }\r\n\r\n    &:disabled {\r\n      opacity: 0.5;\r\n      cursor: not-allowed;\r\n\r\n      &:hover {\r\n        transform: none;\r\n        box-shadow: none;\r\n        border-color: var(--theme-elevation-150, #e0e0e0);\r\n      }\r\n    }\r\n\r\n    &--active {\r\n      border-color: var(--theme-elevation-500, #4a90e2);\r\n      border-width: 3px;\r\n      box-shadow: 0 0 0 3px var(--theme-elevation-100, rgba(74, 144, 226, 0.2));\r\n    }\r\n  }\r\n}\r\n\r\n// Responsive adjustments\r\n@media (max-width: 768px) {\r\n  .color-picker {\r\n    &__input-group {\r\n      flex-wrap: wrap;\r\n    }\r\n\r\n    &__presets-grid {\r\n      grid-template-columns: repeat(auto-fill, minmax(32px, 1fr));\r\n    }\r\n\r\n    &__preset {\r\n      width: 32px;\r\n      height: 32px;\r\n    }\r\n  }\r\n}\r\n\r\n.color-cell {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.25rem;\r\n  .cell-indicator {\r\n    width: 18px;\r\n    height: 18px;\r\n    border-radius: var(--border-radius-xs, 3px);\r\n    border: 2px solid var(--theme-elevation-150, #e0e0e0);\r\n    background-color: #fff;\r\n    box-shadow: 0 1px 2px var(--theme-elevation-100, rgba(0,0,0,0.05));\r\n    transition: border-color 0.2s;\r\n  }\r\n\r\n}\r\n",
      "type": "registry:file",
      "target": "~/src/fields/color-picker/style.scss"
    },
    {
      "path": "registry/fields/color-picker/types.ts",
      "content": "import { TextField } from 'payload'\r\n\r\nexport type ColorPickerArgs = {\r\n  /**\r\n   * The name of the field.\r\n   * @default 'color'\r\n   */\r\n  name?: string\r\n  /**\r\n   * Required field indicator.\r\n   * @default false\r\n   */\r\n  required?: boolean\r\n  /**\r\n   * An array of color presets to choose from.\r\n   */\r\n  colorPresets?: string[]\r\n  /**\r\n   * Debounce delay in milliseconds\r\n   * @default 300\r\n   */\r\n  debounceDelay?: number\r\n\r\n  /**\r\n   * A description for the admin UI\r\n   * Same as `admin.description` in a standard Payload field\r\n   */\r\n  description?: string\r\n\r\n  /**\r\n   * Whether to show the text input alongside the color picker.\r\n   * @default true\r\n   */\r\n  showTextInput?: boolean\r\n  /**\r\n   * A function used to override field at a granular level.\r\n   */\r\n  overrides?: (field: TextField) => TextField\r\n}\r\n\r\nexport type ColorPickerProps = Pick<\r\n  ColorPickerArgs,\r\n  'colorPresets' | 'debounceDelay' | 'showTextInput'\r\n>\r\n",
      "type": "registry:file",
      "target": "~/src/fields/color-picker/types.ts"
    }
  ]
}